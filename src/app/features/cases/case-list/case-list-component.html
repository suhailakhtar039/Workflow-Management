<p *ngIf="(cases$ | async)?.length === 0">No cases found.</p>

<div class="card">
  <p-table
    #dt
    *ngIf="cases$ | async as cases"
    [value]="cases"
    [paginator]="true"
    [rows]="5"
    [rowsPerPageOptions]="[5, 10, 20]"
    [globalFilterFields]="['id', 'title', 'status', 'assignedTo', 'createdAt']"
    sortMode="multiple"
    responsiveLayout="scroll"
  >
    <!-- HEADER TOOLBAR -->
    <ng-template pTemplate="caption">
      <div class="flex justify-content-between align-items-center">
        <h3 class="m-0">Case List</h3>

        <p-iconfield iconPosition="left">
          <p-inputicon>
            <i class="pi pi-search"></i>
          </p-inputicon>
          <input
            pInputText
            type="text"
            (input)="dt.filterGlobal($any($event.target).value, 'contains')"
            placeholder="Search keyword"
          />
        </p-iconfield>
      </div>
    </ng-template>

    <!-- TABLE HEADER -->
    <ng-template pTemplate="header">
      <tr>
        <th pSortableColumn="id">ID <p-sortIcon field="id"></p-sortIcon></th>
        <th pSortableColumn="title">Title <p-sortIcon field="title"></p-sortIcon></th>
        <th pSortableColumn="status">Status <p-sortIcon field="status"></p-sortIcon></th>
        <th pSortableColumn="assignedTo">
          Assigned To <p-sortIcon field="assignedTo"></p-sortIcon>
        </th>
        <th pSortableColumn="createdAt">Created At <p-sortIcon field="createdAt"></p-sortIcon></th>
        <th>Actions</th>
      </tr>
    </ng-template>

    <!-- BODY -->
    <ng-template pTemplate="body" let-caseItem>
      <tr>
        <td>{{ caseItem.id }}</td>
        <td>{{ caseItem.title }}</td>
        <td>{{ caseItem.status }}</td>
        <td>{{ caseItem.assignedTo }}</td>
        <td>{{ caseItem.createdAt | date }}</td>
        <td class="flex gap-2">
          <p-button
            *ngIf="isAdmin$ | async"
            icon="pi pi-pencil"
            severity="info"
            [text]="true"
            (onClick)="onEdit(caseItem)"
          ></p-button>

          <p-button
            *ngIf="(isAdmin$ | async) || (isOfficer$ | async)"
            icon="pi pi-trash"
            severity="danger"
            [text]="true"
            (click)="onDelete(caseItem)"
          ></p-button>

          <span *ngIf="isViewer$ | async" class="text-gray-400"> View Only </span>
          <p-button icon="pi pi-eye" severity="info" (onClick)="onView(caseItem)"></p-button>
        </td>
      </tr>
    </ng-template>
  </p-table>
</div>
